{% macro expanded_card_view(card_id) %}
{% set card = card_info(card_id) %}
{% set attribute = attributes()[card['attribute']] %}
{% set attrib_bg = tex(attribute['background_image_asset']) %}
<div class="card-info">
    <div class="row justify-content-center py-2">
        <div class="col-auto d-flex align-items-end justify-content-xl-end justify-content-md-center">
            <h4 class="mb-0">Card No. {{card['no']}}</h4>
        </div>
        <div class="col-auto d-flex align-items-end justify-content-xl-start justify-content-md-center">
            <img height="32" class="px-1" src="{{member_icon(card['member_id'])}}" />
            <img height="40" class="px-1" src="{{icon(card['rarity'])}}" />
            <img height="32" class="px-1" src="{{icon(card['attribute'])}}" />
            <img height="32" class="px-1" src="{{icon(card['role'])}}" />
            {% if card['is_fes'] %}
            <img height="28" class="px-1" src="{{icon('fes')}}" />
            {% endif %}
        </div>
    </div>
    <a style="text-decoration: none; color: inherit;" href="/card/{{card_id}}">
        <div class="row">
            <div class="col-md-6 text-center py-1">
                {% set appearance = card['appearance']['unidolized'] %}
                <img style="background-image: url({{attrib_bg}}); background-size: contain;" class="w-100"
                    src="{{tex(appearance['full_image_asset'])}}" />
                <caption>{{appearance['name_jp']}}</caption>
                {% if appearance['name_en'] %}
                <caption>/ {{appearance['name_en']}}</caption>
                {% endif %}
            </div>
            <div class="col-md-6 text-center py-1">
                {% set appearance = card['appearance']['idolized'] %}
                <img style="background-image: url({{attrib_bg}}); background-size: contain;" class="w-100"
                    src="{{tex(appearance['full_image_asset'])}}" />
                <caption>{{appearance['name_jp']}}</caption>
                {% if appearance['name_en'] %}
                <caption>/ {{appearance['name_en']}}</caption>
                {% endif %}
            </div>
        </div>
    </a>
    <div class="row justify-content-center py-4">
        <div class="col-md-6">
            <div class="row justify-content-xl-end">
                <div class="col-xl-8">
                    <table class="table table-sm text-center">
                        <thead>
                            <tr>
                                <th scope="col"></th>
                                <th scope="col"><img height="32" src="{{icon('appeal')}}" /></th>
                                <th scope="col"><img height="32" src="{{icon('stamina')}}" /></th>
                                <th scope="col"><img height="32" src="{{icon('technique')}}" />
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">
                                    {% for j in range(5) %}
                                    <img width="16" src="{{icon('lb_empty')}}" />
                                    {% endfor %}
                                </th>
                                {% set stats = card['stats']['stat_summary']['0'] %}
                                <td>{{stats['appeal']}}</td>
                                <td>{{stats['stamina']}}</td>
                                <td>{{stats['technique']}}</td>
                            </tr>
                            <tr>
                                <th scope="row">
                                    {% for j in range(5) %}
                                    <img width="16" src="{{icon('lb_full')}}" />
                                    {% endfor %}
                                </th>
                                {% set stats = card['stats']['stat_summary']['5'] %}
                                <td>{{stats['appeal']}}</td>
                                <td>{{stats['stamina']}}</td>
                                <td>{{stats['technique']}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="row">
                <div class="col-12 row pb-2">
                    {% for skill in card['skills']['active'] %}
                    <div class="col-12 py-1 text-left">
                        <img height="32" src="{{tex(skill['thumbnail_image_asset'])}}" />
                        {{skill|skill_short(split=", ")}}
                    </div>
                    {% endfor %}
                </div>
                <div class="col-12 row pt-2">
                    {% for skill in card['skills']['passive'] %}
                    <div class="col-12 py-1 text-left">
                        <img height="32" src="{{tex(skill['thumbnail_image_asset'])}}" />
                        {{skill|skill_short(split=", ")}}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endmacro %}

{% macro thumb_card_view(card_id) %}
{% set card = card_info(card_id) %}
<div class="card-info mx-auto" style="width: 210px">
    <div class="row justify-content-between text-left">
        <div class="col-4 px-0">
            <h4>#{{card['no']}}</h4>
        </div>
        <div class="col-8 px-0">
            <img height="28" class="float-right px-1" src="{{icon(card['role'])}}" />
            <img height="28" class="float-right px-1" src="{{icon(card['attribute'])}}" />
            <img height="28" class="float-right px-1" src="{{icon(card['rarity'])}}" />
            <img height="28" class="float-right px-1" src="{{member_icon(card['member_id'])}}" />
        </div>
    </div>
    <div class="row justify-content-between">
        <div class="col-6 p-0 text-left">
            <img class="img-fluid" src="{{tex(card['appearance']['unidolized']['thumbnail_image_asset'])}}" />
        </div>
        <div class="col-6 p-0 text-right">
            <img class="img-fluid" src="{{tex(card['appearance']['idolized']['thumbnail_image_asset'])}}" />
        </div>
    </div>
    <div class="row py-1 justify-content-between">
        <div class="col-6 px-0">
            <div class="float-left">
                {% for suit in card['outfits'] %}
                <img title="{{suit|loc_name}}" height="32" src="{{tex(suit['thumbnail_image_asset'])}}" />
                {% endfor %}
            </div>
            <div class="float-right">
                {% if card['is_fes'] %}
                <img title="FES Card / 4 Inspiration Slots" width="48" src="{{icon('fes')}}" />
                {% endif %}
            </div>
        </div>
        <div class="col-6 px-0" style="font-size: 10px;">
            <div class="float-left">
                {% for skill in card['skills']['active'] %}
                <img title="{{skill|skill_short}}" height="32" src="{{tex(skill['thumbnail_image_asset'])}}" />
                {% endfor %}
            </div>
            <div class="float-right">
                {% for skill in card['skills']['passive'] %}
                <img title="{{skill|skill_short}}" height="32" src="{{tex(skill['thumbnail_image_asset'])}}" />
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endmacro %}

{% macro event_cards_list(event) %}
<div class="row py-4">
    <div class="col-12">
        <div class="w-100">
            <img class="img-fluid" style="max-height: 150px;" src="{{banner(event['banner'])}}">
        </div>
        {% if event['name_jp'] %}
        <caption>{{event['name_jp']}}</caption>
        {% if event['name_en'] %}
        <caption> / {{event['name_en']}}</caption>
        {% endif %}
        {% endif %}
    </div>
    <div class="col-12 py-2">
        {% if event['cards'] %}
        <div class="row justify-content-center">
            {% for card in event['cards'] %}
            <div class="col-auto px-5 py-3">
                <a href="/card/{{card}}" style="text-decoration: inherit; color: inherit;">
                    {{thumb_card_view(card)}}
                </a>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% if event['gacha_cards'] %}
        <div class="row text-center py-2">
            <h3 class="mx-auto">Gacha Cards</h4>
        </div>
        <div class="row justify-content-center">
            {% for card in event['gacha_cards'] %}
            <div class="col-auto px-5 py-3">
                <a href="/card/{{card}}" style="text-decoration: inherit; color: inherit;">
                    {{thumb_card_view(card)}}
                </a>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% if event['reward_cards'] %}
        <div class="row text-center py-2">
            <h3 class="mx-auto">Reward Cards</h4>
        </div>
        <div class="row justify-content-center">
            {% for card in event['reward_cards'] %}
            <div class="col-auto px-5 py-3">
                <a href="/card/{{card}}" style="text-decoration: inherit; color: inherit;">
                    {{thumb_card_view(card)}}
                </a>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endmacro %}